â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘          THREAT INTEL LOOKUP APP - QUICK START GUIDE              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ PROJECT STATUS: âœ… SESSION 2 COMPLETE (Enhanced Intelligence)

ğŸ¯ IMPLEMENTED FEATURES:
  âœ“ Session 1: Export Foundation
    - Canonical schema (ThreatIntelResult dataclass)
    - Recommendation engine (BLOCK/MONITOR/INVESTIGATE/ALLOW)
    - 3 export formats (JSON, CSV, PDF)

  âœ“ Session 2: Enhanced Intelligence
    - 4 API sources (AbuseIPDB, OTX, VirusTotal, GreyNoise)
    - MITRE ATT&CK mapping (691 techniques via library)
    - Cyber Kill Chain mapping (7 stages)
    - Confidence scoring algorithm
    - VirusTotal rate limiting (4/min, 500/day)
    - GreyNoise RIOT detection

ğŸ§ª TEST RESULTS:
  âœ“ Component Tests: 5/5 PASSED
  âœ“ Normalizer Tests: 3/3 PASSED
  âœ“ Flask App: Starts successfully

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸš€ RUNNING THE APPLICATION

1. Download MITRE ATT&CK data (ONE-TIME SETUP):
   $ source venv/bin/activate
   $ python3 scripts/download_mitre_data.py

   This downloads ~43MB of MITRE ATT&CK Enterprise data for offline use.
   Update every 6-12 months to get latest techniques.

2. Activate virtual environment:
   $ source venv/bin/activate

3. Start the Flask application:
   $ python3 app.py

4. Access the application:
   ğŸŒ Local:   http://127.0.0.1:5000
   ğŸŒ Network: http://10.0.0.65:5000

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ§ª RUNNING TESTS

Component tests:
  $ source venv/bin/activate
  $ python3 test_components.py

Normalization tests:
  $ source venv/bin/activate
  $ python3 test_normalizer.py

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ PROJECT STRUCTURE

pythonfinalproject/
â”œâ”€â”€ app.py                    # Flask app entry point
â”œâ”€â”€ config.py                 # Configuration management
â”œâ”€â”€ requirements.txt          # Python dependencies
â”‚
â”œâ”€â”€ models/                   # Database layer
â”‚   â”œâ”€â”€ database.py          # Context managers for DB
â”‚   â”œâ”€â”€ cache.py             # Caching with dataclass
â”‚   â”œâ”€â”€ schema.sql           # MySQL schema
â”‚   â””â”€â”€ init_db.py           # DB initialization
â”‚
â”œâ”€â”€ routes/                   # Flask routes
â”‚   â””â”€â”€ threat_intel.py      # Threat intel endpoints
â”‚
â”œâ”€â”€ services/                 # API integration
â”‚   â”œâ”€â”€ threat_intel_client.py  # Base ABC client
â”‚   â”œâ”€â”€ abuseipdb_client.py     # AbuseIPDB API
â”‚   â””â”€â”€ otx_client.py           # OTX API
â”‚
â”œâ”€â”€ utils/                    # Utilities
â”‚   â”œâ”€â”€ ip_validator.py      # IP validation
â”‚   â”œâ”€â”€ normalizer.py        # Data normalization
â”‚   â””â”€â”€ logger.py            # Logging config
â”‚
â”œâ”€â”€ templates/threat_intel/   # UI templates
â”‚   â”œâ”€â”€ index.html           # IP lookup form
â”‚   â””â”€â”€ results.html         # Results display
â”‚
â””â”€â”€ static/css/              # Styling
    â””â”€â”€ threat_intel.css     # Dark theme

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”‘ CONFIGURATION

Required environment variables in .env:

  # Database
  DB_HOST=localhost
  DB_PORT=3306
  DB_USER=root
  DB_PASSWORD=root
  DB_NAME=threat_intel_db

  # API Keys (Required)
  ABUSEIPDB_API_KEY=your_abuseipdb_key
  OTX_API_KEY=your_otx_key

  # API Keys (Optional - Session 2)
  VIRUSTOTAL_API_KEY=your_virustotal_key  # Free: 4/min, 500/day
  GREYNOISE_API_KEY=your_greynoise_key    # Falls back to Community API

  # Settings
  CACHE_TTL_SECONDS=3600
  API_TIMEOUT_SECONDS=10
  FLASK_ENV=development

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ PYTHON CONCEPTS DEMONSTRATED

  âœ“ Context Managers (__enter__, __exit__)
  âœ“ Decorators (with parameters)
  âœ“ Abstract Base Classes (ABC)
  âœ“ Dataclasses
  âœ“ List/Dict/Set Comprehensions
  âœ“ Properties (@property)
  âœ“ Class Methods (@classmethod, @staticmethod)
  âœ“ Type Hints (Union, List, Dict, Optional)
  âœ“ Custom Exceptions
  âœ“ Singleton Pattern
  âœ“ Exponential Backoff
  âœ“ Template Method Pattern
  âœ“ OOP Principles

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š API SOURCES (4 Integrated)

  1. AbuseIPDB:
     â€¢ Abuse confidence score (0-100)
     â€¢ Total reports & categories
     â€¢ Country/ISP information
     â€¢ Free tier: 1,000 requests/day

  2. AlienVault OTX:
     â€¢ Pulse count & reputation
     â€¢ Malware associations
     â€¢ Threat types
     â€¢ Free tier: Unlimited

  3. VirusTotal:
     â€¢ Malicious detections
     â€¢ File/URL associations
     â€¢ Community votes
     â€¢ Free tier: 4 requests/min, 500/day

  4. GreyNoise:
     â€¢ RIOT (benign service detection)
     â€¢ Classification (malicious/benign/unknown)
     â€¢ Scanner classification
     â€¢ Community API: Free (limited data)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ LOGS

Application logs in logs/ directory:
  â€¢ threat_intel_app.log         (all logs)
  â€¢ threat_intel_app_errors.log  (errors only)

Automatic rotation at 10MB, keeps 5 backups.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ LEARNING OUTCOMES

This project demonstrates:
  â€¢ Professional Python application structure
  â€¢ Advanced Python concepts in practice
  â€¢ RESTful API integration
  â€¢ Database design and optimization
  â€¢ Caching strategies
  â€¢ Error handling and logging
  â€¢ Web application development with Flask
  â€¢ Security best practices

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… PROJECT COMPLETE - READY FOR USE
Let me give you some good test IPs that will demonstrate different risk levels: High Risk IPs (for testing BLOCK recommendations):
185.220.101.1 - Known Tor exit node, should have high risk score
45.148.10.124 - Often flagged for malicious activity
Medium Risk IPs (for testing MONITOR recommendations):
80.82.77.139 - Some reports but not critical
194.38.20.66 - Moderate threat indicators
Low Risk IPs (for testing INVESTIGATE/ALLOW recommendations):
8.8.8.8 - Google DNS (should be clean)
1.1.1.1 - Cloudflare DNS (should be clean)
Recommended for testing: Try 185.220.101.1 first - based on your previous test, this gave:
Risk Score: 97/100 (HIGH RISK)
Recommendation: BLOCK (CRITICAL)
Total Reports: 232
Sources: AlienVault OTX + AbuseIPDB
This will let you see the full export functionality with a high-risk IP that has rich data. You can access the app at http://localhost:5000 and test all three export formats (JSON, CSV, PDF).

For this project, the static dictionary approach is appropriate because:

Simplicity - No additional dependencies (attackcti, stix2)
Performance - No API calls or file parsing at runtime
Reliability - Works offline, no rate limits
Scope - We're mapping IP threat categories (limited set), not full malware analysis
When to upgrade to MITRE STIX:

If you need malware family â†’ technique mapping
If you need technique descriptions, mitigations
If you need to stay current with ATT&CK updates automatically
For a production enterprise tool

